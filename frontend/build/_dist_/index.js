var u=(r,t,l)=>new Promise((n,s)=>{var d=i=>{try{a(l.next(i))}catch(c){s(c)}},h=i=>{try{a(l.throw(i))}catch(c){s(c)}},a=i=>i.done?n(i.value):Promise.resolve(i.value).then(d,h);a((l=l.apply(r,t)).next())});import o from"../web_modules/mdui.js";import"./normalize.css.proxy.js";import"./mdui.css.proxy.js";import"./index.css.proxy.js";import m from"./shortlink.js";var e=o.$;if(window.$=o.$,e("title").html(location.host),e(".mdui-typo-headline").html(location.host),e("#short").on("click",()=>u(this,null,function*(){if(e("#need_shorturl").val()==="")return;try{new URL(e("#need_shorturl").val())}catch(s){try{new URL("http://"+e("#need_shorturl").val())}catch(d){return}e("#need_shorturl").val("http://"+e("#need_shorturl").val())}const r=e("#need_shorturl").val();o.updateTextFields();let t=o.dialog({title:"Loading...",content:'<div class="mdui-spinner mdui-theme-pink"></div>',buttons:[],closeOnEsc:!1});o.mutation();let l=new m(r,`${window.location.origin}/api/jsonrpc`),n=yield l.random();console.log(n),t.close(),o.dialog({title:"Shortened URL Created",content:`<div class="mdui-textfield mdui-textfield-floating-label">
    <i class="mdui-icon material-icons">link</i>
    <label class="mdui-textfield-label">Shortened URL</label>
    <input class="mdui-textfield-input" type="url" value="${n}" disabled/>
    </div>`,buttons:[{text:"\u786E\u8BA4"}]}),o.updateTextFields()})),"serviceWorker"in navigator){navigator.serviceWorker.register("/sw.js",{scope:"/"}).then(function(t){console.log("ServiceWorker registration successful with scope: ",t.scope)}).catch(function(t){console.warn("ServiceWorker registration failed: ",t)});let r=!1;navigator.serviceWorker.addEventListener("controllerchange",()=>{if(r)return;r=!0,alert("\u6B63\u5728\u66F4\u65B0Service Worker\u7248\u672C \u8BF7\u7A0D\u540E\u2026\u2026"),console.log("Service Worker \u66F4\u65B0\u4E2D\u2026\u2026"),window.location.reload()})}
